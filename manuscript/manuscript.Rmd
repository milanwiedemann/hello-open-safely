---
title: "Hello OpenSAFELY"
description: | 
  Reproducible scientific writing, native to the web
date: "`r lubridate::today()`"
repository_url: https://github.com/milanwiedemann/hello-open-safely
author:
  - first_name: "Milan"
    last_name: "Wiedemann"
    url: https://github.com/milanwiedemann
    affiliation: University of Oxford, Nuffield Department of Primary Care Health Sciences
    affiliation_url: https://www.bennett.ox.ac.uk/
    orcid_id: 0000-0003-1991-282X

output:
  # bookdown::pdf_document2: default
  # bookdown::html_document2: default
  # bookdown::word_document2: default
  distill::distill_article: default
bibliography: "references.bib"
link-citations: true
---

# Introduction

Introduce this idea

# Idea

# Markdown 

How does Markdown work?

# Citations and cross-references

## Reference manager

- Zotero
- Paperpile

Adding a reference from a bib file that gets automatically created by Paperpile [@Curtis2021-an].
Here's another OpenSAFELY paper @Williamson2020-dt.

# Code chunks

## R

```{r}
# Let's use R to solve this for us and store the result in a new object
results <- 1 + 1

# Return results here
results
```


## Python 

# Inline code

Some complex calculations here.

We can also use inline R chunks to return the result in a sentence.
The answer of our problem above is: `r results`.

# Tables

```{r mtcars}
knitr::kable(mtcars[1:4,1:4], 
             caption = "The mtcars data.")
```

Really important numbers, see Table \@ref(tab:mtcars).

# Figures

Add figure

# Output formats

- html
- pdf
- word

- some templates already exist or can be created manually to match journal requirements.
- distill might also be an option 
  - https://rstudio.github.io/distill/
  - https://rstudio.github.io/distill/publish_article.html
  - https://rstudio.github.io/distill/metadata.html

# OpenSAFELY Output

```{r}
df_input <- readr::read_csv(
  here::here("output", "input.csv"),
  col_types = readr::cols(patient_id = readr::col_integer(),
                          age = readr::col_double())
)

# Create age histogram 
plot_age <- ggplot2::ggplot(data = df_input, 
                            ggplot2::aes(age, fill = sex)) + 
              ggplot2::geom_histogram(bins = 20) +
              ggplot2::labs(x = "Age (in years)",
                            y = "Count") +
              ggplot2::theme(text = ggplot2::element_text(size = 14)) +
              ggplot2::facet_wrap(~factor(sex, 
                                          levels = c("F", "M"),
                                          labels = c("Female", "Male"))) +
              ggplot2::scale_fill_viridis_d(end = .75)

plot_age
```

# Google drive

for collaborations integrate googledrive for easier use of google docs

- https://googledrive.tidyverse.org/index.html

# Customisations and extensions

# References